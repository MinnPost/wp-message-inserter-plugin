;(function($) {
"use strict";

/**
 * Sets cookies
 *
 * @param {string} name
 * @param {string} value
 * @param {number} days
 */
function setCookie(name, value, days) {
  var d = new Date();
  d.setTime(d.getTime() + 86400000 * days);
  document.cookie = name + '=' + value + ';path=/;expires=' + d.toGMTString();
}
/**
 * Reads cookies
 *
 * @param {string} name
 */


function getCookie(name) {
  var v = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
  return v ? v[2] : null;
}
/**
 * Creating Analytics events
 *
 * @param {string} type
 * @param {string} category
 * @param {string} action
 * @param {string} label
 * @param {mixed} value
 */


function analyticsTrackingEvent(type, category, action, label, value) {
  if ('undefined' !== typeof ga) {
    if ('undefined' === typeof value) {
      ga('send', type, category, action, label);
    } else {
      ga('send', type, category, action, label, value);
    }
  } else {
    return;
  }
}
/**
 * Faux "Session" checking/setting
 *
 * @return {number} currentCount
 */


function setCurrentCount() {
  // Timestamp stored on the cookie
  var currentCount = getCookie('count');
  var timestamp = Math.floor(new Date().getTime() / 1000);
  var cookieExpiration = 30; // expire the cooke in 30 days

  if (!getCookie('count')) {
    // First Visit - set count to 1
    setCookie('count', 1, cookieExpiration); // Set a timecheck cookie for an hour from now

    setCookie('timecheck', timestamp + 3600, cookieExpiration);
  } else if (timestamp > getCookie('timecheck')) {
    // Update Timecheck to new value
    setCookie('timecheck', timestamp + 3600, cookieExpiration); // Count exists already and it has been an hour. Update count

    setCookie('count', ++currentCount, cookieExpiration);
  }

  var urlParams = new URLSearchParams(window.location.search);

  if (urlParams.get('count') !== null) {
    currentCount = parseInt(urlParams.get('count'));
  }

  return currentCount;
}
/**
 * Get the WordPress post ID for a given popup.
 *
 * @param {string} popupSelector
 * @return {number} postId
 */


function getPostId(popupSelector) {
  var postId = '';
  var classList = $('.' + popupSelector).attr('class').split(/\s+/);
  $.each(classList, function (index, item) {
    if (0 < item.indexOf('message-id')) {
      postId = item.substring(item.lastIndexOf('-') + 1);
      return false; // break each and postId will be returned
    }
  });
  return postId;
}
/**
 * Show a specific popup. Sets a cookie and adds a visibility class.
 *
 * @param {string} popupSelector
 * @param {number} cookieDayTotal
 * @param {string} popupShownCookieName
 * @param {string} popupVisibleClass
 */


function showPopup(popupSelector, cookieDayTotal, popupShownCookieName, popupVisibleClass) {
  setCookie(popupShownCookieName, 'true', cookieDayTotal);

  if (0 < $('.validated').length) {
    $('.' + popupSelector + '.validated').addClass(popupVisibleClass);
  } else {
    $('.' + popupSelector + ':first').addClass(popupVisibleClass);
  }

  var popupId = getPostId(popupSelector);
  analyticsTrackingEvent('event', 'Popup', 'Show', popupId, {
    'nonInteraction': 1
  });
}
/**
 * Show a specific popup. Sets a cookie and adds a visibility class.
 *
 * @param {string} popupSelector
 * @param {string} popupVisibleClass
 * @param {Object} lastFocus
 * @param {string} closeTrigger
 */


function hidePopup(popupSelector, popupVisibleClass, lastFocus, closeTrigger) {
  lastFocus.focus();
  $('.' + popupSelector).removeClass(popupVisibleClass);
  var popupId = getPostId(popupSelector);
  analyticsTrackingEvent('event', 'Popup', closeTrigger, popupId, {
    'nonInteraction': 1
  });
}
/**
 * Display and controls for popups
 *
 * @param {string} popupSelector
 * @param {number} cookieDayTotal
 * @param {string} popupShownCookieName
 * @param {string} popupVisibleClass
 * @param {string} checkSessionClass
 */


function popupDisplay(popupSelector, cookieDayTotal, popupShownCookieName, popupVisibleClass, checkSessionClass) {
  var lastFocus = document.activeElement; // put in a close button at the end

  $('.' + popupSelector + ' .m-wp-insert-message-item').append('<a href="#" class="sm-close-btn" aria-label="Close"><i class="fas fa-times" aria-hidden="true"></i></a>'); // Check if we should be showing the popup

  if ('true' !== getCookie(popupShownCookieName) && !$('.' + popupSelector).hasClass(checkSessionClass)) {
    showPopup(popupSelector, cookieDayTotal, popupShownCookieName, popupVisibleClass);
  } // click on login link inside popup


  $('.' + popupSelector).on('click', '.message-login', function () {
    var url = $(this).attr('href');
    analyticsTrackingEvent('event', 'Popup', 'Login Link', url);
  });
  document.addEventListener('click', function (event) {
    if (!$(event.target).closest('.' + popupSelector).is('.' + popupSelector) && $('.' + popupSelector).hasClass(popupVisibleClass)) {
      hidePopup(popupSelector, popupVisibleClass, lastFocus, 'Click Elsewhere');
    }
  }, true); // popup close button

  $('.' + popupSelector).on('click', '.sm-close-btn', function (e) {
    e.preventDefault();
    hidePopup(popupSelector, popupVisibleClass, lastFocus, 'Close Button');
  }); // escape key press

  $(document).keyup(function (e) {
    if (27 === e.keyCode) {
      hidePopup(popupSelector, popupVisibleClass, lastFocus, 'Escape Key');
    }
  }); // click on a non-login or close link inside popup

  $('.' + popupSelector).on('click', 'a:not( .sm-close-btn, .message-login )', function () {
    var popupId = getPostId(popupSelector);
    analyticsTrackingEvent('event', 'Popup', 'Click', popupId);
  });
}
/**
 * When jQuery is loaded, set up session tracking and popup display
 *
 */


$(document).ready(function () {
  var popupSelector = 'wp-message-inserter-message-popup';
  var popupShownCookieName = 'sm-shown';
  var popupVisibleClass = 'wp-message-inserter-message-popup-visible';
  var checkSessionClass = 'check-session-message'; // Get our value for days and hours to set cookie

  var closeTimeDays = parseInt($('.' + popupSelector).data('close-time-days')) || 0;
  var closeTimeHours = (parseInt($('.' + popupSelector).data('close-time-hours')) || 0) / 24; // Our Total for when the cookie should expire and show the banner again

  var cookieDayTotal = closeTimeDays + closeTimeHours; // Session Validating and showing proper banner

  var operators = {
    gt: function gt(a, b) {
      return a >= b;
    },
    lt: function lt(a, b) {
      return a <= b;
    }
  };
  var currentCount = setCurrentCount();

  if (0 < $('.' + checkSessionClass).length) {
    $('.' + checkSessionClass).each(function () {
      var bannerSessionCount = parseInt($(this).data('session-count-to-check'));
      var bannerSessionOperator = $(this).data('session-count-operator');

      if (operators[bannerSessionOperator](currentCount, bannerSessionCount)) {
        if (!$(this).hasClass(popupSelector)) {
          $(this).addClass('validated');
        } else if (!getCookie(popupShownCookieName)) {
          $(this).addClass('validated');
        }
      }
    });
  }

  if (0 < $('.' + popupSelector).length) {
    popupDisplay(popupSelector, cookieDayTotal, popupShownCookieName, popupVisibleClass);
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAxLW1lc3NhZ2VzLmpzIl0sIm5hbWVzIjpbInNldENvb2tpZSIsIm5hbWUiLCJ2YWx1ZSIsImRheXMiLCJkIiwiRGF0ZSIsInNldFRpbWUiLCJnZXRUaW1lIiwiZG9jdW1lbnQiLCJjb29raWUiLCJ0b0dNVFN0cmluZyIsImdldENvb2tpZSIsInYiLCJtYXRjaCIsImFuYWx5dGljc1RyYWNraW5nRXZlbnQiLCJ0eXBlIiwiY2F0ZWdvcnkiLCJhY3Rpb24iLCJsYWJlbCIsImdhIiwic2V0Q3VycmVudENvdW50IiwiY3VycmVudENvdW50IiwidGltZXN0YW1wIiwiTWF0aCIsImZsb29yIiwiY29va2llRXhwaXJhdGlvbiIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiZ2V0IiwicGFyc2VJbnQiLCJnZXRQb3N0SWQiLCJwb3B1cFNlbGVjdG9yIiwicG9zdElkIiwiY2xhc3NMaXN0IiwiJCIsImF0dHIiLCJzcGxpdCIsImVhY2giLCJpbmRleCIsIml0ZW0iLCJpbmRleE9mIiwic3Vic3RyaW5nIiwibGFzdEluZGV4T2YiLCJzaG93UG9wdXAiLCJjb29raWVEYXlUb3RhbCIsInBvcHVwU2hvd25Db29raWVOYW1lIiwicG9wdXBWaXNpYmxlQ2xhc3MiLCJsZW5ndGgiLCJhZGRDbGFzcyIsInBvcHVwSWQiLCJoaWRlUG9wdXAiLCJsYXN0Rm9jdXMiLCJjbG9zZVRyaWdnZXIiLCJmb2N1cyIsInJlbW92ZUNsYXNzIiwicG9wdXBEaXNwbGF5IiwiY2hlY2tTZXNzaW9uQ2xhc3MiLCJhY3RpdmVFbGVtZW50IiwiYXBwZW5kIiwiaGFzQ2xhc3MiLCJvbiIsInVybCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsImNsb3Nlc3QiLCJpcyIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImtleXVwIiwia2V5Q29kZSIsInJlYWR5IiwiY2xvc2VUaW1lRGF5cyIsImRhdGEiLCJjbG9zZVRpbWVIb3VycyIsIm9wZXJhdG9ycyIsImd0IiwiYSIsImIiLCJsdCIsImJhbm5lclNlc3Npb25Db3VudCIsImJhbm5lclNlc3Npb25PcGVyYXRvciJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQU9BLFNBQVNBLFNBQVQsQ0FBb0JDLElBQXBCLEVBQTBCQyxLQUExQixFQUFpQ0MsSUFBakMsRUFBd0M7QUFDdkMsTUFBTUMsQ0FBQyxHQUFHLElBQUlDLElBQUosRUFBVjtBQUNBRCxFQUFBQSxDQUFDLENBQUNFLE9BQUYsQ0FBV0YsQ0FBQyxDQUFDRyxPQUFGLEtBQWdCLFdBQVdKLElBQXRDO0FBQ0FLLEVBQUFBLFFBQVEsQ0FBQ0MsTUFBVCxHQUFrQlIsSUFBSSxHQUFHLEdBQVAsR0FBYUMsS0FBYixHQUFxQixrQkFBckIsR0FBMENFLENBQUMsQ0FBQ00sV0FBRixFQUE1RDtBQUNBO0FBRUQ7Ozs7Ozs7QUFLQSxTQUFTQyxTQUFULENBQW9CVixJQUFwQixFQUEyQjtBQUMxQixNQUFNVyxDQUFDLEdBQUdKLFFBQVEsQ0FBQ0MsTUFBVCxDQUFnQkksS0FBaEIsQ0FBdUIsWUFBWVosSUFBWixHQUFtQixlQUExQyxDQUFWO0FBQ0EsU0FBT1csQ0FBQyxHQUFHQSxDQUFDLENBQUUsQ0FBRixDQUFKLEdBQVksSUFBcEI7QUFDQTtBQUVEOzs7Ozs7Ozs7OztBQVNBLFNBQVNFLHNCQUFULENBQWlDQyxJQUFqQyxFQUF1Q0MsUUFBdkMsRUFBaURDLE1BQWpELEVBQXlEQyxLQUF6RCxFQUFnRWhCLEtBQWhFLEVBQXdFO0FBQ3ZFLE1BQUssZ0JBQWdCLE9BQU9pQixFQUE1QixFQUFpQztBQUNoQyxRQUFLLGdCQUFnQixPQUFPakIsS0FBNUIsRUFBb0M7QUFDbkNpQixNQUFBQSxFQUFFLENBQUUsTUFBRixFQUFVSixJQUFWLEVBQWdCQyxRQUFoQixFQUEwQkMsTUFBMUIsRUFBa0NDLEtBQWxDLENBQUY7QUFDQSxLQUZELE1BRU87QUFDTkMsTUFBQUEsRUFBRSxDQUFFLE1BQUYsRUFBVUosSUFBVixFQUFnQkMsUUFBaEIsRUFB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QUFELENBQXlCZ0IsTUFBbEMsRUFBMkM7QUFDMUNRLElBQUFBLFlBQVksQ0FBRXhCLGFBQUYsRUFBaUJhLGNBQWpCLEVBQWlDQyxvQkFBakMsRUFBdURDLGlCQUF2RCxDQUFaO0FBQ0E7QUFDRCxDQTlDRCIsImZpbGUiOiJ3cC1tZXNzYWdlLWluc2VydGVyLXBsdWdpbi1mcm9udC1lbmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNldHMgY29va2llc1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBkYXlzXG4gKi9cbmZ1bmN0aW9uIHNldENvb2tpZSggbmFtZSwgdmFsdWUsIGRheXMgKSB7XG5cdGNvbnN0IGQgPSBuZXcgRGF0ZSgpO1xuXHRkLnNldFRpbWUoIGQuZ2V0VGltZSgpICsgKCA4NjQwMDAwMCAqIGRheXMgKSApO1xuXHRkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz0nICsgdmFsdWUgKyAnO3BhdGg9LztleHBpcmVzPScgKyBkLnRvR01UU3RyaW5nKCk7XG59XG5cbi8qKlxuICogUmVhZHMgY29va2llc1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKi9cbmZ1bmN0aW9uIGdldENvb2tpZSggbmFtZSApIHtcblx0Y29uc3QgdiA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCggJyhefDspID8nICsgbmFtZSArICc9KFteO10qKSg7fCQpJyApO1xuXHRyZXR1cm4gdiA/IHZbIDIgXSA6IG51bGw7XG59XG5cbi8qKlxuICogQ3JlYXRpbmcgQW5hbHl0aWNzIGV2ZW50c1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnlcbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAqIEBwYXJhbSB7c3RyaW5nfSBsYWJlbFxuICogQHBhcmFtIHttaXhlZH0gdmFsdWVcbiAqL1xuZnVuY3Rpb24gYW5hbHl0aWNzVHJhY2tpbmdFdmVudCggdHlwZSwgY2F0ZWdvcnksIGFjdGlvbiwgbGFiZWwsIHZhbHVlICkge1xuXHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2YgZ2EgKSB7XG5cdFx0aWYgKCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHZhbHVlICkge1xuXHRcdFx0Z2EoICdzZW5kJywgdHlwZSwgY2F0ZWdvcnksIGFjdGlvbiwgbGFiZWwgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Z2EoICdzZW5kJywgdHlwZSwgY2F0ZWdvcnksIGFjdGlvbiwgbGFiZWwsIHZhbHVlICk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHJldHVybjtcblx0fVxufVxuXG4vKipcbiAqIEZhdXggXCJTZXNzaW9uXCIgY2hlY2tpbmcvc2V0dGluZ1xuICpcbiAqIEByZXR1cm4ge251bWJlcn0gY3VycmVudENvdW50XG4gKi9cbmZ1bmN0aW9uIHNldEN1cnJlbnRDb3VudCgpIHtcblx0Ly8gVGltZXN0YW1wIHN0b3JlZCBvbiB0aGUgY29va2llXG5cdGxldCBjdXJyZW50Q291bnQgPSBnZXRDb29raWUoICdjb3VudCcgKTtcblx0Y29uc3QgdGltZXN0YW1wID0gTWF0aC5mbG9vciggbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwICk7XG5cdGNvbnN0IGNvb2tpZUV4cGlyYXRpb24gPSAzMDsgLy8gZXhwaXJlIHRoZSBjb29rZSBpbiAzMCBkYXlzXG5cdGlmICggISBnZXRDb29raWUoICdjb3VudCcgKSApIHtcblx0XHQvLyBGaXJzdCBWaXNpdCAtIHNldCBjb3VudCB0byAxXG5cdFx0c2V0Q29va2llKCAnY291bnQnLCAxLCBjb29raWVFeHBpcmF0aW9uICk7XG5cdFx0Ly8gU2V0IGEgdGltZWNoZWNrIGNvb2tpZSBmb3IgYW4gaG91ciBmcm9tIG5vd1xuXHRcdHNldENvb2tpZSggJ3RpbWVjaGVjaycsIHRpbWVzdGFtcCArIDM2MDAsIGNvb2tpZUV4cGlyYXRpb24gKTtcblx0fSBlbHNlIGlmICggdGltZXN0YW1wID4gZ2V0Q29va2llKCAndGltZWNoZWNrJyApICkge1xuXHRcdC8vIFVwZGF0ZSBUaW1lY2hlY2sgdG8gbmV3IHZhbHVlXG5cdFx0c2V0Q29va2llKCAndGltZWNoZWNrJywgdGltZXN0YW1wICsgMzYwMCwgY29va2llRXhwaXJhdGlvbiApO1xuXHRcdC8vIENvdW50IGV4aXN0cyBhbHJlYWR5IGFuZCBpdCBoYXMgYmVlbiBhbiBob3VyLiBVcGRhdGUgY291bnRcblx0XHRzZXRDb29raWUoICdjb3VudCcsICsrY3VycmVudENvdW50LCBjb29raWVFeHBpcmF0aW9uICk7XG5cdH1cblx0Y29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyggd2luZG93LmxvY2F0aW9uLnNlYXJjaCApO1xuXHRpZiAoIHVybFBhcmFtcy5nZXQoICdjb3VudCcgKSAhPT0gbnVsbCApIHtcblx0XHRjdXJyZW50Q291bnQgPSBwYXJzZUludCggdXJsUGFyYW1zLmdldCggJ2NvdW50JyApICk7XG5cdH1cblx0cmV0dXJuIGN1cnJlbnRDb3VudDtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIFdvcmRQcmVzcyBwb3N0IElEIGZvciBhIGdpdmVuIHBvcHVwLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwb3B1cFNlbGVjdG9yXG4gKiBAcmV0dXJuIHtudW1iZXJ9IHBvc3RJZFxuICovXG5mdW5jdGlvbiBnZXRQb3N0SWQoIHBvcHVwU2VsZWN0b3IgKSB7XG4gICAgdmFyIHBvc3RJZCA9ICcnO1xuICAgIHZhciBjbGFzc0xpc3QgPSAkKCAnLicgKyBwb3B1cFNlbGVjdG9yICkuYXR0ciggJ2NsYXNzJyApLnNwbGl0KCAvXFxzKy8gKTtcbiAgICAkLmVhY2goIGNsYXNzTGlzdCwgZnVuY3Rpb24oIGluZGV4LCBpdGVtICkge1xuICAgICAgICBpZiAoIDAgPCBpdGVtLmluZGV4T2YoICdtZXNzYWdlLWlkJyApICkge1xuICAgICAgICAgICAgcG9zdElkID0gaXRlbS5zdWJzdHJpbmcoIGl0ZW0ubGFzdEluZGV4T2YoICctJyApICsgMSApO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBicmVhayBlYWNoIGFuZCBwb3N0SWQgd2lsbCBiZSByZXR1cm5lZFxuICAgICAgICB9XG4gICAgfSApO1xuICAgIHJldHVybiBwb3N0SWQ7XG59XG5cbi8qKlxuICogU2hvdyBhIHNwZWNpZmljIHBvcHVwLiBTZXRzIGEgY29va2llIGFuZCBhZGRzIGEgdmlzaWJpbGl0eSBjbGFzcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9wdXBTZWxlY3RvclxuICogQHBhcmFtIHtudW1iZXJ9IGNvb2tpZURheVRvdGFsXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9wdXBTaG93bkNvb2tpZU5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBwb3B1cFZpc2libGVDbGFzc1xuICovXG5mdW5jdGlvbiBzaG93UG9wdXAoIHBvcHVwU2VsZWN0b3IsIGNvb2tpZURheVRvdGFsLCBwb3B1cFNob3duQ29va2llTmFtZSwgcG9wdXBWaXNpYmxlQ2xhc3MgKSB7XG5cdHNldENvb2tpZSggcG9wdXBTaG93bkNvb2tpZU5hbWUsICd0cnVlJywgY29va2llRGF5VG90YWwgKTtcblx0aWYgKCAwIDwgJCggJy52YWxpZGF0ZWQnICkubGVuZ3RoICkge1xuXHRcdCQoICcuJyArIHBvcHVwU2VsZWN0b3IgKyAnLnZhbGlkYXRlZCcgKS5hZGRDbGFzcyggcG9wdXBWaXNpYmxlQ2xhc3MgKTtcblx0fSBlbHNlIHtcblx0XHQkKCAnLicgKyBwb3B1cFNlbGVjdG9yICsgJzpmaXJzdCcgKS5hZGRDbGFzcyggcG9wdXBWaXNpYmxlQ2xhc3MgKTtcblx0fVxuXHRjb25zdCBwb3B1cElkID0gZ2V0UG9zdElkKCBwb3B1cFNlbGVjdG9yICk7XG5cdGFuYWx5dGljc1RyYWNraW5nRXZlbnQoICdldmVudCcsICdQb3B1cCcsICdTaG93JywgcG9wdXBJZCwgeyAnbm9uSW50ZXJhY3Rpb24nOiAxIH0gKTtcbn1cblxuLyoqXG4gKiBTaG93IGEgc3BlY2lmaWMgcG9wdXAuIFNldHMgYSBjb29raWUgYW5kIGFkZHMgYSB2aXNpYmlsaXR5IGNsYXNzLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwb3B1cFNlbGVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9wdXBWaXNpYmxlQ2xhc3NcbiAqIEBwYXJhbSB7T2JqZWN0fSBsYXN0Rm9jdXNcbiAqIEBwYXJhbSB7c3RyaW5nfSBjbG9zZVRyaWdnZXJcbiAqL1xuZnVuY3Rpb24gaGlkZVBvcHVwKCBwb3B1cFNlbGVjdG9yLCBwb3B1cFZpc2libGVDbGFzcywgbGFzdEZvY3VzLCBjbG9zZVRyaWdnZXIgKSB7XG5cdGxhc3RGb2N1cy5mb2N1cygpO1xuXHQkKCAnLicgKyBwb3B1cFNlbGVjdG9yICkucmVtb3ZlQ2xhc3MoIHBvcHVwVmlzaWJsZUNsYXNzICk7XG5cdGNvbnN0IHBvcHVwSWQgPSBnZXRQb3N0SWQoIHBvcHVwU2VsZWN0b3IgKTtcblx0YW5hbHl0aWNzVHJhY2tpbmdFdmVudCggJ2V2ZW50JywgJ1BvcHVwJywgY2xvc2VUcmlnZ2VyLCBwb3B1cElkLCB7ICdub25JbnRlcmFjdGlvbic6IDEgfSApO1xufVxuXG4vKipcbiAqIERpc3BsYXkgYW5kIGNvbnRyb2xzIGZvciBwb3B1cHNcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9wdXBTZWxlY3RvclxuICogQHBhcmFtIHtudW1iZXJ9IGNvb2tpZURheVRvdGFsXG4gKiBAcGFyYW0ge3N0cmluZ30gcG9wdXBTaG93bkNvb2tpZU5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBwb3B1cFZpc2libGVDbGFzc1xuICogQHBhcmFtIHtzdHJpbmd9IGNoZWNrU2Vzc2lvbkNsYXNzXG4gKi9cbmZ1bmN0aW9uIHBvcHVwRGlzcGxheSggcG9wdXBTZWxlY3RvciwgY29va2llRGF5VG90YWwsIHBvcHVwU2hvd25Db29raWVOYW1lLCBwb3B1cFZpc2libGVDbGFzcywgY2hlY2tTZXNzaW9uQ2xhc3MgKSB7XG5cdGNvbnN0IGxhc3RGb2N1cyA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdC8vIHB1dCBpbiBhIGNsb3NlIGJ1dHRvbiBhdCB0aGUgZW5kXG5cdCQoICcuJyArIHBvcHVwU2VsZWN0b3IgKyAnIC5tLXdwLWluc2VydC1tZXNzYWdlLWl0ZW0nICkuYXBwZW5kKCAnPGEgaHJlZj1cIiNcIiBjbGFzcz1cInNtLWNsb3NlLWJ0blwiIGFyaWEtbGFiZWw9XCJDbG9zZVwiPjxpIGNsYXNzPVwiZmFzIGZhLXRpbWVzXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPjwvYT4nICk7XG5cdC8vIENoZWNrIGlmIHdlIHNob3VsZCBiZSBzaG93aW5nIHRoZSBwb3B1cFxuXHRpZiAoXG5cdFx0J3RydWUnICE9PSBnZXRDb29raWUoIHBvcHVwU2hvd25Db29raWVOYW1lICkgJiZcblx0XHQhICQoICcuJyArIHBvcHVwU2VsZWN0b3IgKS5oYXNDbGFzcyggY2hlY2tTZXNzaW9uQ2xhc3MgKVxuXHQpIHtcblx0XHRzaG93UG9wdXAoIHBvcHVwU2VsZWN0b3IsIGNvb2tpZURheVRvdGFsLCBwb3B1cFNob3duQ29va2llTmFtZSwgcG9wdXBWaXNpYmxlQ2xhc3MgKTtcblx0fVxuXG5cdC8vIGNsaWNrIG9uIGxvZ2luIGxpbmsgaW5zaWRlIHBvcHVwXG5cdCQoICcuJyArIHBvcHVwU2VsZWN0b3IgKS5vbiggJ2NsaWNrJywgJy5tZXNzYWdlLWxvZ2luJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHVybCA9ICQoIHRoaXMgKS5hdHRyKCAnaHJlZicgKTtcblx0XHRhbmFseXRpY3NUcmFja2luZ0V2ZW50KCAnZXZlbnQnLCAnUG9wdXAnLCAnTG9naW4gTGluaycsIHVybCApO1xuXHR9ICk7XG5cblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdGlmIChcblx0XHRcdCEgJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggJy4nICsgcG9wdXBTZWxlY3RvciApLmlzKCAnLicgKyBwb3B1cFNlbGVjdG9yICkgJiZcblx0XHRcdCQoICcuJyArIHBvcHVwU2VsZWN0b3IgKS5oYXNDbGFzcyggcG9wdXBWaXNpYmxlQ2xhc3MgKVxuXHRcdCkge1xuXHRcdFx0aGlkZVBvcHVwKCBwb3B1cFNlbGVjdG9yLCBwb3B1cFZpc2libGVDbGFzcywgbGFzdEZvY3VzLCAnQ2xpY2sgRWxzZXdoZXJlJyApO1xuXHRcdH1cblx0fSwgdHJ1ZSApO1xuXG5cdC8vIHBvcHVwIGNsb3NlIGJ1dHRvblxuXHQkKCAnLicgKyBwb3B1cFNlbGVjdG9yICkub24oICdjbGljaycsICcuc20tY2xvc2UtYnRuJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGhpZGVQb3B1cCggcG9wdXBTZWxlY3RvciwgcG9wdXBWaXNpYmxlQ2xhc3MsIGxhc3RGb2N1cywgJ0Nsb3NlIEJ1dHRvbicgKTtcblx0fSApO1xuXG5cdC8vIGVzY2FwZSBrZXkgcHJlc3Ncblx0JCggZG9jdW1lbnQgKS5rZXl1cCggZnVuY3Rpb24oIGUgKSB7XG5cdFx0aWYgKCAyNyA9PT0gZS5rZXlDb2RlICkge1xuXHRcdFx0aGlkZVBvcHVwKCBwb3B1cFNlbGVjdG9yLCBwb3B1cFZpc2libGVDbGFzcywgbGFzdEZvY3VzLCAnRXNjYXBlIEtleScgKTtcblx0XHR9XG5cdH0gKTtcblxuXHQvLyBjbGljayBvbiBhIG5vbi1sb2dpbiBvciBjbG9zZSBsaW5rIGluc2lkZSBwb3B1cFxuXHQkKCAnLicgKyBwb3B1cFNlbGVjdG9yICkub24oICdjbGljaycsICdhOm5vdCggLnNtLWNsb3NlLWJ0biwgLm1lc3NhZ2UtbG9naW4gKScsIGZ1bmN0aW9uKCkge1xuXHRcdGNvbnN0IHBvcHVwSWQgPSBnZXRQb3N0SWQoIHBvcHVwU2VsZWN0b3IgKTtcblx0XHRhbmFseXRpY3NUcmFja2luZ0V2ZW50KCAnZXZlbnQnLCAnUG9wdXAnLCAnQ2xpY2snLCBwb3B1cElkICk7XG5cdH0gKTtcbn1cblxuLyoqXG4gKiBXaGVuIGpRdWVyeSBpcyBsb2FkZWQsIHNldCB1cCBzZXNzaW9uIHRyYWNraW5nIGFuZCBwb3B1cCBkaXNwbGF5XG4gKlxuICovXG4kKCBkb2N1bWVudCApLnJlYWR5KCBmdW5jdGlvbigpIHtcblx0Y29uc3QgcG9wdXBTZWxlY3RvciA9ICd3cC1tZXNzYWdlLWluc2VydGVyLW1lc3NhZ2UtcG9wdXAnO1xuXHRjb25zdCBwb3B1cFNob3duQ29va2llTmFtZSA9ICdzbS1zaG93bic7XG5cdGNvbnN0IHBvcHVwVmlzaWJsZUNsYXNzID0gJ3dwLW1lc3NhZ2UtaW5zZXJ0ZXItbWVzc2FnZS1wb3B1cC12aXNpYmxlJztcblx0Y29uc3QgY2hlY2tTZXNzaW9uQ2xhc3MgPSAnY2hlY2stc2Vzc2lvbi1tZXNzYWdlJztcblxuXHQvLyBHZXQgb3VyIHZhbHVlIGZvciBkYXlzIGFuZCBob3VycyB0byBzZXQgY29va2llXG5cdGNvbnN0IGNsb3NlVGltZURheXMgPSBwYXJzZUludCggJCggJy4nICsgcG9wdXBTZWxlY3RvciApLmRhdGEoICdjbG9zZS10aW1lLWRheXMnICkgKSB8fCAwO1xuXHRjb25zdCBjbG9zZVRpbWVIb3VycyA9ICggcGFyc2VJbnQoICQoICcuJyArIHBvcHVwU2VsZWN0b3IgKS5kYXRhKCAnY2xvc2UtdGltZS1ob3VycycgKSApIHx8IDAgKSAvIDI0O1xuXHQvLyBPdXIgVG90YWwgZm9yIHdoZW4gdGhlIGNvb2tpZSBzaG91bGQgZXhwaXJlIGFuZCBzaG93IHRoZSBiYW5uZXIgYWdhaW5cblx0Y29uc3QgY29va2llRGF5VG90YWwgPSBjbG9zZVRpbWVEYXlzICsgY2xvc2VUaW1lSG91cnM7XG5cblx0Ly8gU2Vzc2lvbiBWYWxpZGF0aW5nIGFuZCBzaG93aW5nIHByb3BlciBiYW5uZXJcblx0Y29uc3Qgb3BlcmF0b3JzID0ge1xuXHRcdGd0KCBhLCBiICkge1xuXHRcdFx0cmV0dXJuIGEgPj0gYjtcblx0XHR9LFxuXHRcdGx0KCBhLCBiICkge1xuXHRcdFx0cmV0dXJuIGEgPD0gYjtcblx0XHR9LFxuXHR9O1xuXG5cdGNvbnN0IGN1cnJlbnRDb3VudCA9IHNldEN1cnJlbnRDb3VudCgpO1xuXG5cdGlmICggMCA8ICQoICcuJyArIGNoZWNrU2Vzc2lvbkNsYXNzICkubGVuZ3RoICkge1xuXHRcdCQoICcuJyArIGNoZWNrU2Vzc2lvbkNsYXNzICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRjb25zdCBiYW5uZXJTZXNzaW9uQ291bnQgPSBwYXJzZUludCggJCggdGhpcyApLmRhdGEoICdzZXNzaW9uLWNvdW50LXRvLWNoZWNrJyApICk7XG5cdFx0XHRjb25zdCBiYW5uZXJTZXNzaW9uT3BlcmF0b3IgPSAkKCB0aGlzICkuZGF0YSggJ3Nlc3Npb24tY291bnQtb3BlcmF0b3InICk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdG9wZXJhdG9yc1sgYmFubmVyU2Vzc2lvbk9wZXJhdG9yIF0oXG5cdFx0XHRcdFx0Y3VycmVudENvdW50LFxuXHRcdFx0XHRcdGJhbm5lclNlc3Npb25Db3VudFxuXHRcdFx0XHQpXG5cdFx0XHQpIHtcblx0XHRcdFx0aWYgKCAhICQoIHRoaXMgKS5oYXNDbGFzcyggcG9wdXBTZWxlY3RvciApICkge1xuXHRcdFx0XHRcdCQoIHRoaXMgKS5hZGRDbGFzcyggJ3ZhbGlkYXRlZCcgKTtcblx0XHRcdFx0fSBlbHNlIGlmICggISBnZXRDb29raWUoIHBvcHVwU2hvd25Db29raWVOYW1lICkgKSB7XG5cdFx0XHRcdFx0JCggdGhpcyApLmFkZENsYXNzKCAndmFsaWRhdGVkJyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9XG5cblx0aWYgKCAwIDwgJCggJy4nICsgcG9wdXBTZWxlY3RvciApLmxlbmd0aCApIHtcblx0XHRwb3B1cERpc3BsYXkoIHBvcHVwU2VsZWN0b3IsIGNvb2tpZURheVRvdGFsLCBwb3B1cFNob3duQ29va2llTmFtZSwgcG9wdXBWaXNpYmxlQ2xhc3MgKTtcblx0fVxufSApO1xuIl19
}(jQuery));
